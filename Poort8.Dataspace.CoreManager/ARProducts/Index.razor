@page "/ar/products"
@rendermode @(new InteractiveServerRenderMode(prerender: false))

<PageTitle>AR Products</PageTitle>

<FluentStack Orientation="Orientation.Vertical" VerticalGap=20>
    <FluentLabel Typo="Typography.H1">Authorization Registry Products</FluentLabel>

    <FluentButton IconStart="@(new Icons.Regular.Size20.AddCircle())" Appearance="Appearance.Accent" OnClick="@(AddNewClicked)">New Product</FluentButton>

    <FluentDataGrid Items="@Products">
        <PropertyColumn Title="Identifier" Property="@(o => o.ProductId)" Sortable="true" />
        <PropertyColumn Property="@(o => o.Name)" Sortable="true" />
        <PropertyColumn Property="@(o => o.Description)" Sortable="false" />
        <PropertyColumn Property="@(o => o.Provider)" Sortable="false" />
        <PropertyColumn Property="@(o => o.Url)" Sortable="false" />
        <TemplateColumn Title="Actions" Align="@Align.End">
            <FluentButton Title="Details" IconEnd="@(new Icons.Regular.Size16.Info())" OnClick="@(() => DetailsClicked(@context))" />
            <FluentButton Title="Properties" IconEnd="@(new Icons.Regular.Size16.TagMultiple())" OnClick="@(() => PropertiesClicked(@context))" />
            <FluentButton Title="Delete" IconEnd="@(new Icons.Regular.Size16.Delete())" OnClick="@(() => DeleteClicked(@context))" />
        </TemplateColumn>
    </FluentDataGrid>

    <FluentLabel Typo="Typography.H2">Product Features</FluentLabel>

    <FluentDataGrid Items="@Features">
        <PropertyColumn Title="" Property="@(o => o.Name)" Sortable="true" />
            @foreach (var product in Products!)
        {
            <TemplateColumn Title="@product.Name" Align="@Align.Center">
                <FluentCheckbox Value="@(product.Features.Any(o => o.FeatureId == context.FeatureId))" ValueChanged="@((v) => ProductFeatureClicked(product.ProductId, context.FeatureId, v))" />
            </TemplateColumn>
        }
    </FluentDataGrid>
</FluentStack>
